!function(d){var c=function(a,b){this.$element=d(a);this.options=d.extend({},d.fn.typeahead.defaults,b);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.$menu=d(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=false;this.listen()};c.prototype={constructor:c,select:function(){var a=this.$menu.find(".active").attr("data-value");this.$element.val(a);return this.hide()},show:function(){var a=d.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:a.top+a.height,left:a.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(b){var g=this,h,a;this.query=this.$element.val();if(!this.query){return this.shown?this.hide():this}h=d.grep(this.source,function(e){if(g.matcher(e)){return e}});h=this.sorter(h);if(!h.length){return this.shown?this.hide():this}return this.render(h.slice(0,this.options.items)).show()},matcher:function(a){return ~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(h){var b=[],i=[],j=[],a;while(a=h.shift()){if(!a.toLowerCase().indexOf(this.query.toLowerCase())){b.push(a)}else{if(~a.indexOf(this.query)){i.push(a)}else{j.push(a)}}}return b.concat(i,j)},highlighter:function(a){return a.replace(new RegExp("("+this.query+")","ig"),function(f,b){return"<strong>"+b+"</strong>"})},render:function(b){var a=this;b=d(b).map(function(h,g){h=d(a.options.item).attr("data-value",g);h.find("a").html(a.highlighter(g));return h[0]});b.first().addClass("active");this.$menu.html(b);return this},next:function(b){var a=this.$menu.find(".active").removeClass("active"),f=a.next();if(!f.length){f=d(this.$menu.find("li")[0])}f.addClass("active")},prev:function(b){var a=this.$menu.find(".active").removeClass("active"),f=a.prev();if(!f.length){f=this.$menu.find("li").last()}f.addClass("active")},listen:function(){this.$element.on("blur",d.proxy(this.blur,this)).on("keypress",d.proxy(this.keypress,this)).on("keyup",d.proxy(this.keyup,this));if(d.browser.webkit||d.browser.msie){this.$element.on("keydown",d.proxy(this.keypress,this))}this.$menu.on("click",d.proxy(this.click,this)).on("mouseenter","li",d.proxy(this.mouseenter,this))},keyup:function(a){a.stopPropagation();a.preventDefault();switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:this.hide();break;default:this.lookup()}},keypress:function(a){a.stopPropagation();if(!this.shown){return}switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault();this.prev();break;case 40:a.preventDefault();this.next();break}},blur:function(a){var b=this;a.stopPropagation();a.preventDefault();setTimeout(function(){b.hide()},150)},click:function(a){a.stopPropagation();a.preventDefault();this.select()},mouseenter:function(a){this.$menu.find(".active").removeClass("active");d(a.currentTarget).addClass("active")}};d.fn.typeahead=function(a){return this.each(function(){var b=d(this),g=b.data("typeahead"),h=typeof a=="object"&&a;if(!g){b.data("typeahead",(g=new c(this,h)))}if(typeof a=="string"){g[a]()}})};d.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'};d.fn.typeahead.Constructor=c;d(function(){d("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(a){var b=d(this);if(b.data("typeahead")){return}a.preventDefault();b.typeahead(b.data())})})}(window.jQuery);